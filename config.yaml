model:
  pretrained_model_path: "Qwen2.5-3B-Instruct"
  device: "cuda"
  dtype: "bfloat16"

data:
  path: "gsm8k"          # ← 你的 GSM8K 数据存放目录
  config_name: "main"    # ← 可选: "main" 或 "socratic"
  test_size: 128

training:
  random_seed: 1337

  # GSM8K 题目较长，把 prompt 长度稍微调大
  max_prompt_len: 512
  max_gen_len: 1024

  batch_size: 256
  num_questions_per_batch: 32

  micro_batch_size: 2
  max_grad_norm: 1.0
  learning_rate: 1.0e-5
  weight_decay: 0.0
  betas: [0.9, 0.999]

  ckpt_dir: "ckpt"
  log_dir: "logs"

  skip_unfinished_episodes: false
  ckpt_save_interval: 100
  eval_interval: 10

  memory_efficient_adamw: false

  num_epochs: 3        # 训练轮数（跑完整个数据集的次数）。不设则默认 1
  max_steps: null      # 限制总步数（全局 step 计数）。例如 2000；设为 null/0/不写表示不限制
  
wandb:
  enable: true
  project: mathgrpo
  entity: amdyes   # 可选
  run_name: ""                    # 为空则用时间戳
  mode: online                    # 或 offline/disabled
  watch_model: false              # 是否记录梯度/参数直方图
  watch_log_freq: 100
  log_text_every: 100             # 多久记录一次文本样例
  num_text_samples: 4             # 每次记录多少条样例
  save_ckpt_artifact: false       # 是否把 ckpt 作为 artifact 上传
  artifact_name_prefix: grpo-qwen